CLASSES_ROOT\CLSID\{F5078F36-C551-11D3-89B9-0000F81FE221}\TypeLib" owner="false">
      <registryValue name="" valueType="REG_SZ" value="{F5078F18-C551-11D3-89B9-0000F81FE221}" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F40-C551-11D3-89B9-0000F81FE221}" owner="false">
      <registryValue name="" valueType="REG_SZ" value="XML Document 3.0" operationHint="replace" owner="true"></registryValue>
      <securityDescriptor name="WRP_REGKEY_DEFAULT_SDDL"></securityDescriptor>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F40-C551-11D3-89B9-0000F81FE221}\BrowseInPlace" owner="false"></registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F40-C551-11D3-89B9-0000F81FE221}\DefaultIcon" owner="false">
      <registryValue name="" valueType="REG_EXPAND_SZ" value="%SystemRoot%\System32\msxml3.dll,0" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F40-C551-11D3-89B9-0000F81FE221}\MiscStatus" owner="false">
      <registryValue name="" valueType="REG_SZ" value="2228625" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F40-C551-11D3-89B9-0000F81FE221}\InProcServer32" owner="false">
      <registryValue name="ThreadingModel" valueType="REG_SZ" value="Apartment" operationHint="replace" owner="true"></registryValue>
      <registryValue name="" valueType="REG_EXPAND_SZ" value="%SystemRoot%\System32\msxml3.dll" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F40-C551-11D3-89B9-0000F81FE221}\ProgID" owner="false">
      <registryValue name="" valueType="REG_SZ" value="xmlfile" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F40-C551-11D3-89B9-0000F81FE221}\Version" owner="false">
      <registryValue name="" valueType="REG_SZ" value="3.0" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F3F-C551-11D3-89B9-0000F81FE221}" owner="false">
      <registryValue name="" valueType="REG_SZ" value="XML Moniker 3.0" operationHint="replace" owner="true"></registryValue>
      <securityDescriptor name="WRP_REGKEY_DEFAULT_SDDL"></securityDescriptor>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F3F-C551-11D3-89B9-0000F81FE221}\InProcServer32" owner="false">
      <registryValue name="ThreadingModel" valueType="REG_SZ" value="Apartment" operationHint="replace" owner="true"></registryValue>
      <registryValue name="" valueType="REG_EXPAND_SZ" value="%SystemRoot%\System32\msxml3.dll" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F41-C551-11D3-89B9-0000F81FE221}" owner="false">
      <registryValue name="" valueType="REG_SZ" value="XML Island 3.0" operationHint="replace" owner="true"></registryValue>
      <securityDescriptor name="WRP_REGKEY_DEFAULT_SDDL"></securityDescriptor>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F41-C551-11D3-89B9-0000F81FE221}\InProcServer32" owner="false">
      <registryValue name="ThreadingModel" valueType="REG_SZ" value="Apartment" operationHint="replace" owner="true"></registryValue>
      <registryValue name="" valueType="REG_EXPAND_SZ" value="%SystemRoot%\System32\msxml3.dll" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{F5078F41-C551-11D3-89B9-0000F81FE221}\TypeLib" owner="false">
      <registryValue name="" valueType="REG_SZ" value="{F5078F18-C551-11D3-89B9-0000F81FE221}" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{079AA557-4A18-424A-8EEE-E39F0A8D41B9}" owner="false">
      <registryValue name="" valueType="REG_SZ" value="SAX XML Reader" operationHint="replace" owner="true"></registryValue>
      <securityDescriptor name="WRP_REGKEY_DEFAULT_SDDL"></securityDescriptor>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{079AA557-4A18-424A-8EEE-E39F0A8D41B9}\InProcServer32" owner="false">
      <registryValue name="ThreadingModel" valueType="REG_SZ" value="Both" operationHint="replace" owner="true"></registryValue>
      <registryValue name="" valueType="REG_EXPAND_SZ" value="%SystemRoot%\System32\msxml3.dll" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{079AA557-4A18-424A-8EEE-E39F0A8D41B9}\ProgID" owner="false">
      <registryValue name="" valueType="REG_SZ" value="Msxml2.SAXXMLReader" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{079AA557-4A18-424A-8EEE-E39F0A8D41B9}\VersionIndependentProgID" owner="false">
      <registryValue name="" valueType="REG_SZ" value="Msxml2.SAXXMLReader" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{079AA557-4A18-424A-8EEE-E39F0A8D41B9}\Version" owner="false">
      <registryValue name="" valueType="REG_SZ" value="3.0" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{079AA557-4A18-424A-8EEE-E39F0A8D41B9}\TypeLib" owner="false">
      <registryValue name="" valueType="REG_SZ" value="{F5078F18-C551-11D3-89B9-0000F81FE221}" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{3124C396-FB13-4836-A6AD-1317F1713688}" owner="false">
      <registryValue name="" valueType="REG_SZ" value="SAX XML Reader 3.0" operationHint="replace" owner="true"></registryValue>
      <securityDescriptor name="WRP_REGKEY_DEFAULT_SDDL"></securityDescriptor>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{3124C396-FB13-4836-A6AD-1317F1713688}\InProcServer32" owner="false">
      <registryValue name="ThreadingModel" valueType="REG_SZ" value="Both" operationHint="replace" owner="true"></registryValue>
      <registryValue name="" valueType="REG_EXPAND_SZ" value="%SystemRoot%\System32\msxml3.dll" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{3124C396-FB13-4836-A6AD-1317F1713688}\ProgID" owner="false">
      <registryValue name="" valueType="REG_SZ" value="Msxml2.SAXXMLReader.3.0" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{3124C396-FB13-4836-A6AD-1317F1713688}\VersionIndependentProgID" owner="false">
      <registryValue name="" valueType="REG_SZ" value="Msxml2.SAXXMLReader" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{3124C396-FB13-4836-A6AD-1317F1713688}\Version" owner="false">
      <registryValue name="" valueType="REG_SZ" value="3.0" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{3124C396-FB13-4836-A6AD-1317F1713688}\TypeLib" owner="false">
      <registryValue name="" valueType="REG_SZ" value="{F5078F18-C551-11D3-89B9-0000F81FE221}" operationHint="replace" owner="true"></registryValue>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{FC220AD8-A72A-4EE8-926E-0B7AD152A020}" owner="false">
      <registryValue name="" valueType="REG_SZ" value="MXXMLWriter" operationHint="replace" owner="true"></registryValue>
      <securityDescriptor name="WRP_REGKEY_DEFAULT_SDDL"></securityDescriptor>
    </registryKey>
    <registryKey keyName="HKEY_CLASSES_ROOT\CLSID\{FC220AD8-A72A-4EE8-926E-0B7AD152A020}\InProcServer32" owner="false">
      <registryValue name="ThreadingModel" valueType="REG_SZ" value="umnHeader sortableColumn = column as SortableColumnHeader;
				if (sortableColumn != null && sortableColumn.Sorter == base.ListViewItemSorter)
				{
					sortColumn = sortableColumn;
					this.SelectedColumn = sortColumn.Index;
					break;
				}
			}

			// Update the arrow image on each column header
			IntPtr header = SendMessage(new HandleRef(this, this.Handle), LVM_GETHEADER, 0, 0);
			if (header != IntPtr.Zero)
			{
				HDITEM hdi = new HDITEM();
				hdi.mask = HDI_FORMAT | HDI_IMAGE;
				foreach (System.Windows.Forms.ColumnHeader column in base.Columns)
				{
					// Set the text aligment
					hdi.fmt = (int)column.TextAlign;

					// Set the image
					hdi.iImage = -1;
					if (column == sortColumn)
					{
						hdi.iImage = (sortColumn.Sorter.SortDirection == ListSortDirection.Ascending) ? 0 : 1;
						hdi.fmt |= HDF_IMAGE;
					}

					// Set the format
					if (column.Text != null && column.Text.Length > 0)
					{
						hdi.fmt |= HDF_STRING | HDF_BITMAP_ON_RIGHT;
					}
					else
					{
						hdi.fmt &= ~HDF_JUSTIFYMASK;
						hdi.fmt |= HDF_CENTER;
					}

					// Update the header item
					int message = (Marshal.SystemDefaultCharSize == 1) ? HDM_SETITEMA : HDM_SETITEMW;
					SendMessage(new HandleRef(this, header), message, column.Index, hdi);
				}
			}
		}
		#endregion

		#region Interop Constants
		// ListView window messages
		const int LVM_FIRST = 0x1000;
		const int LVM_SETEXTENDEDLISTVIEWSTYLE = (LVM_FIRST + 54);
		const int LVM_SETSELECTEDCOLUMN = (LVM_FIRST + 140);
		const int LVM_GETSELECTEDCOLUMN = (LVM_FIRST + 174);
		const int LVM_GETHEADER = (LVM_FIRST + 31);
		const int LVM_SORTITEMS = (LVM_FIRST + 48);
		const int LVM_SETITEMA = (LVM_FIRST + 6);
		const int LVM_SETITEMW = (LVM_FIRST + 76);
		const int LVM_SETITEMTEXTA = (LVM_FIRST + 46);
		const int LVM_SETITEMTEXTW = (LVM_FIRST + 116);

		// ListView extended styles
		const int LVS_EX_SUBITEMIMAGES = 0x00000002;
		const int LVS_EX_DOUBLEBUFFER = 0x00010000;

		// ListView item flags
		const int LVIF_TEXT = 0x0001;
		const int LVIF_IMAGE = 0x0002;

		// Header window messages
		const int HDM_FIRST = 0x1200;
		const int HDM_SETIMAGELIST = (HDM_FIRST + 8);
		const int HDM_SETITEMA = (HDM_FIRST + 4);
		const int HDM_SETITEMW = (HDM_FIRST + 12);

		// Header item data
		const int HDI_FORMAT = 0x0004;
		const int HDI_IMAGE = 0x0020;
		const int HDF_CENTER = 0x0002;
		const int HDF_JUSTIFYMASK = 0x0003;
		const int HDF_STRING = 0x4000;
		const int HDF_BITMAP_ON_RIGHT = 0x1000;
		const int HDF_IMAGE = 0x0800;
		#endregion

		#region Interop Structures
		[StructLayout(LayoutKind.Sequential)]
		private class HDITEM 
		{
			public uint    mask = 0;
			public int     cxy = 0;
			public IntPtr  pszText = IntPtr.Zero;
			public IntPtr  hbm = IntPtr.Zero;
			public int     cchTextMax = 0;
			public int     fmt = 0;
			public IntPtr  lParam = IntPtr.Zero;
			public int     iImage = -1;
			public int     iOrder = 0;
			public uint    type = 0;
			public IntPtr  pvFilter = IntPtr.Zero;
		}

		[StructLayout(LayoutKind.Sequential)]
		private class LVITEM 
		{
			public uint mask = 0;
			public int iItem = 0;
			public int iSubItem = 0;
			public uint state = 0;
			public uint stateMask = 0;
			public IntPtr pszText = IntPtr.Zero;
			public int cchTextMax = 0;
			public int iImage = 0;
			public IntPtr lParam = IntPtr.Zero;
			public int iIndent = 0;
			public int iGroupId = 0;
			public uint cColumns = 0;
			public IntPtr puColumns = IntPtr.Zero;
		}
		#endregion

		#region Interop Methods
		[DllImport("user32.dll", CharSet=CharSet.Auto)]
		private static extern IntPtr SendMessage(HandleRef hWnd, int msg, int wParam, int lParam);
		[DllImport("user32.dll", CharSet=CharSet.Auto)]
		private static extern IntPtr SendMessage(HandleRef hWnd, int msg, int wParam, IntPtr lParam);
		[DllImport("user32.dll", CharSet=CharSet.Auto)]
		private static extern IntPtr SendMessage(HandleRef hWnd, int msg, int wParam, HDITEM lParam);
		#endregion


	}
}
